<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tempo Master Tool</title>
    
    <!-- 1. Load Tailwind CSS Library FIRST -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Configure Tailwind immediately AFTER -->
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Custom scrollbar for lists */
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: transparent;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
        .dark .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: #475569;
        }
        
        /* Loading Spinner */
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #3b82f6;
            width: 20px;
            height: 20px;
            -webkit-animation: spin 1s linear infinite; /* Safari */
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 transition-colors duration-200">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useMemo, useRef, useEffect } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        
        // Import Firebase (Modular SDK)
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { 
            getFirestore, 
            collection, 
            getDocs, 
            doc, 
            setDoc, 
            deleteDoc, 
            onSnapshot
        } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

        import { 
          Users, 
          Search, 
          Map as MapIcon, 
          List, 
          Filter, 
          Mail, 
          Phone, 
          Briefcase, 
          MapPin, 
          Activity,
          UserCircle,
          Download,
          Upload,
          Link as LinkIcon,
          FileSpreadsheet,
          Building,
          UserCheck,
          Moon,
          Sun,
          Eye,
          EyeOff,
          X,
          Calendar,
          CreditCard,
          GraduationCap,
          Globe,
          Truck,
          MessageCircle,
          Hash,
          Heart,
          User,
          ChevronRight,
          BarChart3,
          ChevronDown,
          Edit2,
          Trash2,
          Save,
          Image as ImageIcon,
          RefreshCw
        } from 'https://esm.sh/lucide-react@0.292.0';

        // ---------------------------------------------------------
        // FIREBASE CONFIGURATION
        // ---------------------------------------------------------
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyAJfMGnjV6xnN1ObOJjK7blBK0fCR0NZZk",
            authDomain: "tempomaster1-18ac4.firebaseapp.com",
            projectId: "tempomaster1-18ac4",
            storageBucket: "tempomaster1-18ac4.firebasestorage.app",
            messagingSenderId: "436233309908",
            appId: "1:436233309908:web:48ece8321ceaec29593541",
            measurementId: "G-ZEWW47WNHY"
        };

        // Initialize Firebase
        let db = null;
        try {
            if (FIREBASE_CONFIG && FIREBASE_CONFIG.apiKey) {
                const app = initializeApp(FIREBASE_CONFIG);
                db = getFirestore(app);
                console.log("Firebase initialized successfully");
            }
        } catch (e) { console.error("Firebase Init Error:", e); }

        // --- CONFIGURATION ---
        const GOOGLE_SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTAoGbZAGtMrtw3dRq8eMB9SD-YxgecieLp7b7sXdKruIWvUWVgypfE_X0AgSKgMQ/pub?output=csv";

        // --- HIERARCHY CONFIGURATION (STRICT ORDER) ---
        const TITLE_HIERARCHY = [
          "Site Director",
          "HR Manager",
          "Operation Manager",
          "Workforce Manager",
          "Change Integration Manager",
          "Training & Development Manager",
          "QA Lead",
          "Workforce Analyst",
          "QA",
          "T2/Mentor",
          "T2/Cancellation",
          "T2/Tech",
          "Social Media",
          "MX-T1"
        ];

        // --- INITIAL DATA (Fallback) ---
        const INITIAL_DATA = [];

        // --- COMPONENTS ---

        const StatusBadge = ({ status }) => {
          const normalizedStatus = status ? status.toLowerCase().trim() : '';
          let style = "bg-gray-100 text-gray-500 border-gray-200 dark:bg-slate-700 dark:text-slate-400 dark:border-slate-600";
          
          if (normalizedStatus.includes('active') || normalizedStatus.includes('probation') || normalizedStatus.includes('training')) {
             if (normalizedStatus.includes('inactive')) {
                 style = "bg-red-100 text-red-700 border-red-200 dark:bg-red-900/30 dark:text-red-400 dark:border-red-800";
             } else {
                 style = "bg-green-100 text-green-700 border-green-200 dark:bg-green-900/30 dark:text-green-400 dark:border-green-800";
             }
          } else if (normalizedStatus.includes('leave')) {
            style = "bg-yellow-100 text-yellow-700 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-400 dark:border-yellow-800";
          } else if (normalizedStatus.includes('terminated') || normalizedStatus.includes('resigned')) {
            style = "bg-red-100 text-red-700 border-red-200 dark:bg-red-900/30 dark:text-red-400 dark:border-red-800";
          }
          
          return (
            <span className={`px-2 py-0.5 rounded-full text-xs font-medium border ${style} capitalize`}>
              {status || "Unknown"}
            </span>
          );
        };

        // --- HELPER: AVATAR COMPONENT ---
        const UserAvatar = ({ name, photo, size = "md" }) => {
            const sizeClasses = {
                sm: "w-10 h-10 text-sm",
                md: "w-20 h-20 text-3xl", 
                lg: "w-32 h-32 text-5xl",
                xl: "w-40 h-40 text-6xl"
            };

            const containerClass = `rounded-full flex items-center justify-center font-bold border-2 border-white dark:border-slate-700 shadow-md overflow-hidden ${sizeClasses[size]} shrink-0`;

            if (photo && photo.trim() !== "") {
                return (
                    <div className={`${containerClass} bg-white dark:bg-slate-800`}>
                        <img 
                            src={getDirectImageUrl(photo)} 
                            alt={name} 
                            className="w-full h-full object-cover"
                            onError={(e) => {
                                e.target.style.display = 'none'; // Hide broken image
                                e.target.nextSibling.style.display = 'flex'; // Show fallback
                            }}
                        />
                        <div className="hidden w-full h-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 items-center justify-center">
                            {name ? name.charAt(0) : '?'}
                        </div>
                    </div>
                );
            }

            return (
                <div className={`${containerClass} bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400`}>
                    {name ? name.charAt(0) : '?'}
                </div>
            );
        };

        // --- CHART COMPONENT ---
        const LobChart = ({ data }) => {
          if (!data || data.length === 0) return null;
          
          const max = Math.max(...data.map(d => d.total));
          
          return (
            <div className="bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm mb-8 animate-in fade-in slide-in-from-bottom-2 duration-500">
              <h3 className="text-lg font-bold text-slate-800 dark:text-white mb-6 flex items-center gap-2">
                <BarChart3 size={20} className="text-blue-600 dark:text-blue-400" />
                Headcount Distribution by LOB
              </h3>
              
              <div className="flex items-end justify-around gap-2 sm:gap-4 w-full px-2">
                {data.map((item) => (
                  <div key={item.name} className="flex flex-col items-center gap-2 group w-full">
                    <div className="relative w-full h-48 flex justify-center items-end">
                       <div className="absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-xs font-bold py-1.5 px-2.5 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10 pointer-events-none mb-2">
                          {item.total} Employees
                          <div className="absolute bottom-[-4px] left-1/2 -translate-x-1/2 w-2 h-2 bg-slate-800 rotate-45"></div>
                       </div>
                       <div 
                         className="w-full max-w-[40px] sm:max-w-[60px] bg-blue-500 dark:bg-blue-600 rounded-t-lg transition-all duration-700 ease-out relative hover:brightness-110"
                         style={{ height: `${Math.max((item.total / max) * 100, 2)}%` }} 
                       >
                       </div>
                    </div>
                    <div className="text-center w-full mt-1">
                      <div className="text-sm font-bold text-slate-900 dark:text-white mb-0.5">{item.total}</div>
                      <div className="text-[10px] sm:text-xs font-medium text-slate-500 dark:text-slate-400 break-words leading-tight w-full px-1">
                        {item.name}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          );
        };

        // --- HELPERS ---
        const getDirectImageUrl = (url) => {
            if (!url) return "";
            if (url.startsWith('data:image')) return url; 
            let cleanUrl = url.trim();
            if (cleanUrl.includes("dropbox.com")) return cleanUrl.replace("dl=0", "raw=1");
            if (cleanUrl.includes("drive.google.com/file/d/")) {
                const idMatch = cleanUrl.match(/\/d\/([a-zA-Z0-9_-]+)/);
                if (idMatch && idMatch[1]) return `https://drive.google.com/uc?export=view&id=${idMatch[1]}`;
            }
            return cleanUrl;
        };

        const formatDateForInput = (dateString) => {
            if (!dateString) return '';
            const date = new Date(dateString);
            if (isNaN(date.getTime())) return ''; 
            return date.toISOString().split('T')[0];
        };

        // Centralized Active Status Check
        const isEmployeeActive = (status) => {
            const s = (status || "").toLowerCase().trim();
            if (s.includes('inactive')) return false;
            if (s.includes('terminated')) return false;
            if (s.includes('resigned')) return false;
            if (s.includes('left')) return false;
            
            if (s.includes('active')) return true;
            if (s.includes('probation')) return true;
            if (s.includes('training')) return true;
            
            return true; // Default true if status unknown, change to false if strict
        };

        // --- EDIT FORM COMPONENTS ---
        const EditInputField = ({ label, name, type = "text", value, onChange }) => {
            let displayValue = value || '';
            if (type === 'date' && displayValue) {
               const formatted = formatDateForInput(displayValue);
               if (formatted) displayValue = formatted;
            }

            return (
              <div className="flex flex-col gap-1">
                <label className="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wide">{label}</label>
                <input 
                  type={type} 
                  name={name} 
                  value={displayValue} 
                  onChange={onChange}
                  className="px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none text-slate-900 dark:text-slate-100"
                />
              </div>
            );
        };

        const EditSelectField = ({ label, name, value, options, onChange }) => (
            <div className="flex flex-col gap-1">
              <label className="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wide">{label}</label>
              <select 
                name={name} 
                value={value || ''} 
                onChange={onChange}
                className="px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none text-slate-900 dark:text-slate-100"
              >
                {options.map(opt => (
                  <option key={opt} value={opt}>{opt}</option>
                ))}
              </select>
            </div>
        );

        const ProfileField = ({ label, value, icon: Icon, className = "" }) => (
            <div className={`flex flex-col justify-center gap-0.5 p-2 rounded-lg bg-slate-50 dark:bg-slate-800/50 border border-slate-100 dark:border-slate-700 ${className}`}>
              <span className="text-[9px] uppercase font-bold tracking-wider text-slate-400 dark:text-slate-500 flex items-center gap-1">
                {Icon && <Icon size={9} />} {label}
              </span>
              <span className="text-xs text-slate-900 dark:text-slate-100 font-semibold truncate leading-tight" title={value}>
                {value || "-"}
              </span>
            </div>
        );

        // --- UNIFIED EMPLOYEE MODAL ---
        const EmployeeModal = ({ employee, mode = 'view', onClose, onSave }) => {
          const [formData, setFormData] = useState({ ...employee });
          const isEdit = mode === 'edit';
          const fileInputRef = useRef(null);
          
          const isActive = isEmployeeActive(isEdit ? formData.status : employee.status);

          const handleChange = (e) => {
            const { name, value } = e.target;
            setFormData(prev => ({ ...prev, [name]: value }));
          };

          const handleImageUpload = (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onloadend = () => {
                    setFormData(prev => ({ ...prev, photo: reader.result }));
                };
                reader.readAsDataURL(file);
            }
          };

          const handleSubmit = (e) => {
            e.preventDefault();
            onSave(formData);
          };

          // Add ESC key listener
          useEffect(() => {
            const handleKeyDown = (e) => {
              if (e.key === 'Escape') {
                onClose();
              }
            };
            window.addEventListener('keydown', handleKeyDown);
            return () => window.removeEventListener('keydown', handleKeyDown);
          }, [onClose]);

          // Helper: Unified field rendering
          const UnifiedField = ({ label, name, type = "text", value, onChange, isEdit, icon: Icon, options = [] }) => {
             if (isEdit) {
                 if (type === 'select') {
                     return <EditSelectField label={label} name={name} value={value} options={options} onChange={onChange} />;
                 }
                 return <EditInputField label={label} name={name} type={type} value={value} onChange={onChange} />;
             } else {
                 return <ProfileField label={label} value={value} icon={Icon} />;
             }
          };

          return (
            <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200 overflow-y-auto">
              <div className="absolute inset-0" onClick={onClose}></div>
              <div className="relative bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-5xl border border-slate-200 dark:border-slate-700 flex flex-col my-auto max-h-[90vh]">
                
                {/* Header */}
                <div className="flex items-center justify-between p-5 border-b border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50 rounded-t-xl">
                   <div className="flex items-center gap-4">
                      {isEdit ? (
                          <div className="relative group cursor-pointer shrink-0" onClick={() => fileInputRef.current.click()}>
                            <UserAvatar name={formData.name} photo={formData.photo} size="lg" />
                            <div className="absolute inset-0 bg-black/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <Upload size={32} className="text-white" />
                            </div>
                            <input type="file" ref={fileInputRef} className="hidden" onChange={handleImageUpload} accept="image/*" />
                          </div>
                      ) : (
                          <UserAvatar name={formData.name} photo={formData.photo} size="lg" />
                      )}
                      <div>
                          {isEdit ? (
                              <div className="w-64">
                                  <UnifiedField label="Full Name" name="name" value={formData.name} onChange={handleChange} isEdit={true} />
                              </div>
                          ) : (
                              <h2 className="text-2xl font-bold text-slate-900 dark:text-white leading-none mb-1">{formData.name}</h2>
                          )}
                          
                          {!isEdit && (
                              <div className="flex items-center gap-2 mt-1">
                                <StatusBadge status={formData.status} />
                                <span className="text-xs text-slate-500 dark:text-slate-400 font-mono bg-white dark:bg-slate-900 px-1.5 py-0.5 rounded border border-slate-200 dark:border-slate-700">
                                  ID: {formData.id}
                                </span>
                              </div>
                          )}
                      </div>
                   </div>
                   
                   <button onClick={onClose} className="p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-full transition-colors text-slate-400">
                    <X size={24} />
                  </button>
                </div>
                
                <form onSubmit={handleSubmit} className="p-6 overflow-y-auto flex-1">
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    
                    {/* Column 1: Employment */}
                    <div className="space-y-4">
                        <h3 className="text-xs font-bold text-blue-600 dark:text-blue-400 uppercase tracking-widest border-b border-blue-100 dark:border-blue-900/30 pb-2 mb-2">
                           Employment
                        </h3>
                        {isEdit && <UnifiedField label="Employee ID" name="id" value={formData.id} onChange={handleChange} isEdit={true} />}
                        {isEdit && <UnifiedField label="Photo URL" name="photo" value={formData.photo} onChange={handleChange} isEdit={true} />}
                        
                        {isEdit && (
                            <UnifiedField 
                                label="Status" 
                                name="status" 
                                type="select"
                                options={["Active", "Inactive"]}
                                value={formData.status} 
                                onChange={handleChange} 
                                isEdit={true} 
                            />
                        )}

                        <UnifiedField label="Title" name="title" value={formData.title} onChange={handleChange} isEdit={isEdit} icon={Briefcase} />
                        <UnifiedField label="Supervisor" name="team_lead" value={formData.team_lead} onChange={handleChange} isEdit={isEdit} icon={UserCheck} />
                        
                        {isEdit && <UnifiedField label="Channel (LOB)" name="channel" value={formData.channel} onChange={handleChange} isEdit={true} icon={Building} />}
                        {isEdit && <UnifiedField label="Sub-Channel" name="sub_channel" value={formData.sub_channel} onChange={handleChange} isEdit={true} />}
                        
                        {(!isActive || isEdit) && <UnifiedField label="Rehire Status" name="rehire_status" value={formData.rehire_status} onChange={handleChange} isEdit={isEdit} icon={Hash} />}
                    </div>

                    {/* Column 2: Timeline & Contact */}
                    <div className="space-y-4">
                        <h3 className="text-xs font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest border-b border-indigo-100 dark:border-indigo-900/30 pb-2 mb-2">
                           Timeline & Contact
                        </h3>
                        <div className="grid grid-cols-2 gap-3">
                           <UnifiedField label="Joined" name="joining_date" type="date" value={formData.joining_date} onChange={handleChange} isEdit={isEdit} icon={Calendar} />
                           {(!isActive || isEdit) ? <UnifiedField label="End Date" name="end_date" type="date" value={formData.end_date} onChange={handleChange} isEdit={isEdit} icon={Calendar} /> : <div/>}
                        </div>
                        
                        <div className="grid grid-cols-2 gap-3">
                            <UnifiedField label="Wave" name="wave" value={formData.wave} onChange={handleChange} isEdit={isEdit} icon={Activity} />
                            <UnifiedField label="Born" name="dob" type="date" value={formData.dob} onChange={handleChange} isEdit={isEdit} icon={Calendar} />
                        </div>

                        <div className="pt-2"></div>
                        <UnifiedField label="Tempo Email" name="tempo_email" type="email" value={formData.tempo_email} onChange={handleChange} isEdit={isEdit} icon={Mail} />
                        <UnifiedField label="Personal Email" name="personal_email" type="email" value={formData.personal_email} onChange={handleChange} isEdit={isEdit} icon={Mail} />
                    </div>

                    {/* Column 3: Personal & Details */}
                    <div className="space-y-4">
                        <h3 className="text-xs font-bold text-purple-600 dark:text-purple-400 uppercase tracking-widest border-b border-purple-100 dark:border-purple-900/30 pb-2 mb-2">
                           Personal & Info
                        </h3>
                        
                        <div className="grid grid-cols-2 gap-3">
                            <UnifiedField label="Mobile" name="mobile" value={formData.mobile} onChange={handleChange} isEdit={isEdit} icon={Phone} />
                            <UnifiedField label="Phone" name="phone" value={formData.phone} onChange={handleChange} isEdit={isEdit} icon={Phone} />
                        </div>

                        <div className="grid grid-cols-2 gap-3">
                            <UnifiedField label="Gender" name="gender" value={formData.gender} onChange={handleChange} isEdit={isEdit} icon={User} />
                            <UnifiedField label="Religion" name="religion" value={formData.religion} onChange={handleChange} isEdit={isEdit} icon={Heart} />
                        </div>
                        
                        <UnifiedField label="Route" name="route" value={formData.route} onChange={handleChange} isEdit={isEdit} icon={Truck} />
                        <UnifiedField label="Graduate / Undergrad" name="education" value={formData.education} onChange={handleChange} isEdit={isEdit} icon={GraduationCap} />
                        {isEdit && <UnifiedField label="Area" name="area" value={formData.area} onChange={handleChange} isEdit={true} icon={MapPin} />}
                    </div>

                  </div>
                </form>

                <div className="p-4 border-t border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50 flex justify-end gap-3 rounded-b-xl">
                  <button onClick={onClose} className="px-4 py-2 text-slate-600 dark:text-slate-300 font-medium hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
                    {isEdit ? 'Cancel' : 'Close'}
                  </button>
                  {isEdit && (
                    <button onClick={handleSubmit} className="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors flex items-center gap-2">
                      <Save size={18} /> Save Changes
                    </button>
                  )}
                </div>
              </div>
            </div>
          );
        };

        // --- COMPACT CARD WIDGET ---
        const EmployeeWidget = ({ employee, onClick, onEdit, onDelete }) => {
          return (
            <div 
              onClick={onClick}
              className="group bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-lg hover:border-blue-300 dark:hover:border-blue-700 cursor-pointer transition-all duration-200 flex flex-col overflow-hidden relative animate-in fade-in zoom-in-95 h-full transform hover:-translate-y-1"
            >
              <div className={`h-1.5 w-full ${
                employee.channel === 'MX T1' ? 'bg-indigo-500' :
                employee.channel === 'Engineering' ? 'bg-blue-500' :
                employee.channel === 'Sales' ? 'bg-green-500' :
                employee.channel === 'Finance' ? 'bg-purple-500' :
                'bg-slate-400'
              }`} />

              <div className="p-4 flex-1">
                <div className="flex justify-between items-start mb-2">
                  <UserAvatar name={employee.name} photo={employee.photo} size="md" />
                  <StatusBadge status={employee.status} />
                </div>

                <h3 className="font-bold text-slate-800 dark:text-slate-100 text-lg truncate" title={employee.name}>{employee.name}</h3>
                <p className="text-sm text-slate-500 dark:text-slate-400 flex items-center gap-1 mb-1 truncate">
                  <Briefcase size={14} className="text-slate-400 dark:text-slate-500" /> {employee.title || employee.position}
                </p>
                
                <div className="mt-2 mb-2 text-xs text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-700/50 p-1.5 rounded border border-slate-100 dark:border-slate-600 inline-flex items-center gap-1.5 w-full">
                   <UserCheck size={12} className="text-slate-400 dark:text-slate-500 flex-shrink-0"/> 
                   <span className="truncate">Supervisor: <strong className="text-slate-700 dark:text-slate-300">{employee.team_lead}</strong></span>
                </div>

                <div className="mt-2 pt-3 border-t border-slate-100 dark:border-slate-700 grid grid-cols-2 gap-2 text-xs text-slate-500 dark:text-slate-400">
                   <div className="flex items-center gap-1 truncate" title={employee.channel}>
                      <Building size={12} />
                      <span className="truncate">
                        {employee.channel} 
                        {employee.sub_channel && employee.channel !== 'MX T1' && <span className="text-slate-400">• {employee.sub_channel}</span>}
                      </span>
                   </div>
                   <div className="flex items-center gap-1 truncate">
                      <MapPin size={12} />
                      <span className="truncate">{employee.area}</span>
                   </div>
                </div>
              </div>
              
              {/* Action Bar */}
              <div className="bg-slate-50 dark:bg-slate-900/30 p-3 flex justify-between items-center border-t border-slate-100 dark:border-slate-700">
                <div className="flex gap-1">
                    <button 
                      onClick={(e) => { e.stopPropagation(); onEdit(employee); }}
                      className="p-2 hover:bg-white dark:hover:bg-slate-700 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg transition-colors text-slate-400" 
                      title="Edit"
                    >
                      <Edit2 size={16} />
                    </button>
                    <button 
                      onClick={(e) => { e.stopPropagation(); onDelete(employee.id); }}
                      className="p-2 hover:bg-white dark:hover:bg-slate-700 hover:text-red-600 dark:hover:text-red-400 rounded-lg transition-colors text-slate-400" 
                      title="Delete"
                    >
                      <Trash2 size={16} />
                    </button>
                </div>
                <div className="text-xs font-semibold text-blue-600 dark:text-blue-400 flex items-center gap-1 group-hover:underline">
                  Full Profile <ChevronRight size={14} />
                </div>
              </div>
            </div>
          );
        };

        const EmployeeRow = ({ employee, onClick, onEdit, onDelete }) => (
          <tr 
            onClick={onClick}
            className="hover:bg-blue-50 dark:hover:bg-slate-700/50 border-b border-slate-100 dark:border-slate-700 last:border-0 transition-colors cursor-pointer group"
          >
            <td className="px-6 py-4">
              <div className="flex items-center gap-3">
                <UserAvatar name={employee.name} photo={employee.photo} size="sm" />
                <div>
                  <div className="font-medium text-slate-900 dark:text-slate-100">{employee.name}</div>
                  <div className="text-xs text-slate-500 dark:text-slate-400">ID: {employee.id}</div>
                </div>
              </div>
            </td>
            <td className="px-6 py-4 text-sm text-slate-600 dark:text-slate-300">
                <div className="font-medium text-slate-700 dark:text-slate-200">{employee.title}</div>
                <div className="text-xs text-slate-400">{employee.position}</div>
            </td>
            <td className="px-6 py-4 text-sm text-slate-600 dark:text-slate-400">
                <div className="flex items-center gap-2">
                    <UserCheck size={14} className="text-slate-400 dark:text-slate-500"/>
                    {employee.team_lead}
                </div>
            </td>
            <td className="px-6 py-4">
              <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-200 border border-slate-200 dark:border-slate-600">
                {employee.channel} {employee.sub_channel && `• ${employee.sub_channel}`}
              </span>
            </td>
            <td className="px-6 py-4 text-sm text-slate-600 dark:text-slate-400">
                {employee.joining_date}
            </td>
            <td className="px-6 py-4 flex justify-end gap-2 items-center">
                <StatusBadge status={employee.status} />
                <button 
                  onClick={(e) => { e.stopPropagation(); onEdit(employee); }}
                  className="p-1.5 hover:bg-slate-200 dark:hover:bg-slate-600 rounded text-slate-400 hover:text-blue-500"
                >
                    <Edit2 size={14} />
                </button>
                <button 
                  onClick={(e) => { e.stopPropagation(); onDelete(employee.id); }}
                  className="p-1.5 hover:bg-slate-200 dark:hover:bg-slate-600 rounded text-slate-400 hover:text-red-500"
                >
                    <Trash2 size={14} />
                </button>
            </td>
          </tr>
        );

        function HeadcountDashboard() {
          const [data, setData] = useState(INITIAL_DATA);
          const [viewMode, setViewMode] = useState('map'); 
          const [searchTerm, setSearchTerm] = useState('');
          const [selectedTitle, setSelectedTitle] = useState('All'); 
          const [darkMode, setDarkMode] = useState(false);
          const [showActiveOnly, setShowActiveOnly] = useState(true);
          const [loading, setLoading] = useState(false);
          
          // Unified Modal State
          const [modalEmployee, setModalEmployee] = useState(null); 
          const [modalMode, setModalMode] = useState('view'); // 'view' or 'edit'

          const [expandedStats, setExpandedStats] = useState({}); 
          const fileInputRef = useRef(null);

          // --- MERGED DATA LOGIC: SHEET + FIREBASE ---
          const [sheetEmployees, setSheetEmployees] = useState([]);
          const [firestoreEmployees, setFirestoreEmployees] = useState([]);

          useEffect(() => {
            setLoading(true);
            
            const fetchSheetData = async () => {
                 const ts = new Date().getTime(); // CACHE BUSTER
                 try {
                     const text = await fetchWithRetry(`${GOOGLE_SHEET_URL}&t=${ts}`);
                     const rows = [];
                     let currentRow = "";
                     let inQuotes = false;
                     for (let i = 0; i < text.length; i++) {
                         const char = text[i];
                         if (char === '"') inQuotes = !inQuotes;
                         if ((char === '\n' || char === '\r') && !inQuotes) {
                             if (currentRow.trim()) rows.push(currentRow);
                             currentRow = "";
                         } else currentRow += char;
                     }
                     if (currentRow.trim()) rows.push(currentRow);
                     
                     const parsedSheet = rows.slice(1).map((line, index) => {
                         const v = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(val => val.trim().replace(/^"|"$/g, ''));
                         if (v.length < 5) return null;
                         
                         // UPDATED COLUMN MAPPING
                         let title = (v[6] || "").trim(); // Col G
                         let channel = "Unassigned";

                         const titleLower = title.toLowerCase();
                         let subChannel = "";

                         // Smart Categorization
                         if (titleLower.includes("phone")) { channel = "MX-T1"; subChannel = "Phone"; title = "MX-T1"; }
                         else if (titleLower.includes("chat")) { channel = "MX-T1"; subChannel = "Chat"; title = "MX-T1"; }
                         else if (titleLower.includes("email")) { channel = "MX-T1"; subChannel = "Email"; title = "MX-T1"; }
                         else if (titleLower.includes("mx associate") || titleLower.includes("mx t1")) { channel = "MX-T1"; title = "MX-T1"; }
                         else if (title.includes("Site Director")) channel = "Management";
                         else if (title.includes("HR")) channel = "HR";
                         else if (title.includes("Operation")) channel = "Operations";
                         else if (title.includes("Workforce")) channel = "WFM";
                         else if (title.includes("Change")) channel = "Change";
                         else if (title.includes("Training")) channel = "Training";
                         else if (title.includes("QA")) channel = "Quality";
                         else if (title.includes("T2")) channel = "Tier 2";
                         else if (title.includes("Social")) channel = "Social Media";

                         return {
                           name: v[0] || "Unknown",
                           id: v[1] || `new-${index}`,
                           hr_id: v[2] || "",
                           team_lead: v[3] || "Unassigned",
                           qa_assigned: v[4] || "",
                           position: v[5] || "",
                           title: title, 
                           channel: channel,         
                           sub_channel: subChannel, // KEEP DATA HERE
                           wave: v[7] || "",   
                           dob: v[8] || "",    
                           joining_date: v[9] || "", 
                           status: v[10] || "Unknown",
                           personal_email: v[11] || "",
                           tempo_email: v[12] || "",
                           phone: v[13] || "",
                           route: v[14] || "",
                           religion: v[15] || "",
                           gender: v[16] || "",
                           education: v[17] || "",
                           area: v[18] || "",
                           mobile: v[19] || "",
                           mobile2: v[20] || "",
                           emergency_phone: v[21] || "",
                           address: v[22] || "",
                           transport_point: v[23] || "",
                           end_date: v[24] || "",
                           rehire_status: v[25] || "",
                           reason: v[26] || "",
                           headset_sn: v[27] || "",
                           locker_id: v[28] || "",
                           nationality: v[29] || "",
                           photo: v[32] || ""  // Shifted from v[33]
                         };
                     }).filter(item => item !== null);
                     setSheetEmployees(parsedSheet);
                     if (!db) { setData(parsedSheet); setLoading(false); }
                 } catch (e) {
                     console.error("Critical Sheet Load Error:", e);
                     setLoading(false);
                 }
            };

            fetchSheetData();

            if (db) {
                const unsubscribe = onSnapshot(collection(db, "employees"), (snapshot) => {
                    const fbData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    setFirestoreEmployees(fbData);
                    setLoading(false);
                });
                return () => unsubscribe();
            }
          }, []);

          // --- MERGE LOGIC ---
          useEffect(() => {
             if (sheetEmployees.length === 0 && firestoreEmployees.length === 0) return;

             const mergedMap = new Map();
             
             // 1. Add all Sheet Employees (Handle DUPLICATES by modifying key)
             sheetEmployees.forEach(emp => {
                 if (mergedMap.has(emp.id)) {
                    let uniqueSuffix = 2;
                    while (mergedMap.has(`${emp.id}_${uniqueSuffix}`)) uniqueSuffix++;
                    emp.id = `${emp.id}_${uniqueSuffix}`;
                 }
                 mergedMap.set(emp.id, emp);
             });

             // 2. Overlay Firebase Data (Edits/Deletes/Adds)
             firestoreEmployees.forEach(fbEmp => {
                 if (fbEmp.deleted) {
                     mergedMap.delete(fbEmp.id);
                 } else {
                     const existing = mergedMap.get(fbEmp.id) || {};
                     mergedMap.set(fbEmp.id, { ...existing, ...fbEmp });
                 }
             });

             setData(Array.from(mergedMap.values()));

          }, [sheetEmployees, firestoreEmployees]);


          const handleDelete = async (id) => {
            if (window.confirm("Are you sure?")) {
                if (db) {
                    await setDoc(doc(db, "employees", id), { deleted: true }, { merge: true });
                } else {
                    setData(prev => prev.filter(emp => emp.id !== id));
                }
            }
          };

          const handleUpdate = async (updatedEmployee) => {
            if (db) {
                const cleanData = JSON.parse(JSON.stringify(updatedEmployee));
                await setDoc(doc(db, "employees", updatedEmployee.id), cleanData, { merge: true });
            } else {
                setData(prev => prev.map(emp => emp.id === updatedEmployee.id ? updatedEmployee : emp));
            }
            setModalEmployee(null); 
          };

          const openViewModal = (employee) => { setModalEmployee(employee); setModalMode('view'); };
          const openEditModal = (employee) => { setModalEmployee(employee); setModalMode('edit'); };
          const closeModal = () => { setModalEmployee(null); };

          const getRoleRank = (title) => {
            if (!title) return 999;
            const t = title.toLowerCase();
            const index = TITLE_HIERARCHY.findIndex(rankTitle => t.includes(rankTitle.toLowerCase()));
            return index !== -1 ? index : 999;
          };

          const filterTitles = useMemo(() => {
            const activeData = data.filter(e => isEmployeeActive(e.status));
            const titles = [...new Set(activeData.map(item => item.title))];
            return ['All', ...titles.sort((a, b) => getRoleRank(a) - getRoleRank(b))];
          }, [data]);

          const filteredData = useMemo(() => {
            const result = data.filter(employee => {
              if (showActiveOnly && !isEmployeeActive(employee.status)) return false;
              const searchLower = searchTerm.toLowerCase();
              const matchesSearch = 
                (employee.name?.toLowerCase() || '').includes(searchLower) || 
                (employee.title?.toLowerCase() || '').includes(searchLower) ||
                (employee.id?.toLowerCase() || '').includes(searchLower);
              const matchesTitle = selectedTitle === 'All' || employee.title === selectedTitle;
              return matchesSearch && matchesTitle;
            });
            return result.sort((a, b) => getRoleRank(a.title) - getRoleRank(b.title));
          }, [data, searchTerm, selectedTitle, showActiveOnly]);

          const groupedData = useMemo(() => {
            return filteredData.reduce((acc, employee) => {
              const key = employee.channel || 'Unassigned';
              if (!acc[key]) acc[key] = [];
              acc[key].push(employee);
              return acc;
            }, {});
          }, [filteredData]);

          const lobStats = useMemo(() => {
            const stats = filteredData.reduce((acc, curr) => {
              const channel = curr.channel || 'Unassigned';
              const subChannel = curr.sub_channel;
              if (!acc[channel]) acc[channel] = { total: 0, subChannels: {}, employees: [] }; 
              acc[channel].total += 1;
              acc[channel].employees.push(curr); 
              if (subChannel) acc[channel].subChannels[subChannel] = (acc[channel].subChannels[subChannel] || 0) + 1;
              return acc;
            }, {});
            return Object.entries(stats).sort((a, b) => b[1].total - a[1].total).map(([name, data]) => ({ name, ...data }));
          }, [filteredData]);

          const stats = {
            total: data.length,
            visible: filteredData.length,
            active: data.filter(e => isEmployeeActive(e.status)).length,
            lobs: Object.keys(groupedData).length
          };

          const handleExport = () => {
             const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(filteredData, null, 2));
             const downloadAnchorNode = document.createElement('a');
             downloadAnchorNode.setAttribute("href", dataStr);
             downloadAnchorNode.setAttribute("download", "tempo_export.json");
             document.body.appendChild(downloadAnchorNode);
             downloadAnchorNode.click();
             downloadAnchorNode.remove();
          };

          const handleSheetLink = async () => {
             const url = prompt("Paste CSV Link:", GOOGLE_SHEET_URL);
             if (url) window.location.reload(); 
          };

          // MANUAL SYNC BUTTON HANDLER
          const handleManualSync = () => {
             fetchSheetData(); // Re-runs the fetch logic with new timestamp
          };

          return (
            <div className="min-h-screen bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 font-sans transition-colors duration-200">
                {modalEmployee && (
                  <EmployeeModal 
                    employee={modalEmployee} 
                    mode={modalMode}
                    onClose={closeModal} 
                    onSave={handleUpdate}
                  />
                )}
                <header className="bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-30 shadow-sm">
                  <div className="max-w-[96%] mx-auto px-4 h-16 flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <div className="bg-blue-600 p-2 rounded-lg text-white"><Users size={20} /></div>
                      <h1 className="text-xl font-bold text-slate-800 dark:text-white">Tempo Master Tool</h1>
                      {loading && <div className="loader"></div>}
                    </div>
                    <div className="flex items-center gap-3">
                        <div className="relative">
                            <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" size={18} />
                            <input type="text" placeholder="Search..." className="pl-10 pr-4 py-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-sm border-transparent focus:bg-white dark:focus:bg-slate-600 border outline-none text-slate-800 dark:text-slate-100" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                        </div>
                        <div className="flex bg-slate-100 dark:bg-slate-700 p-1 rounded-lg">
                            <button onClick={() => setViewMode('map')} className={`p-2 rounded ${viewMode === 'map' ? 'bg-white dark:bg-slate-600 shadow' : ''}`} title="Map View"><MapIcon size={18}/></button>
                            <button onClick={() => setViewMode('list')} className={`p-2 rounded ${viewMode === 'list' ? 'bg-white dark:bg-slate-600 shadow' : ''}`} title="List View"><List size={18}/></button>
                            <button onClick={() => setViewMode('stats')} className={`p-2 rounded ${viewMode === 'stats' ? 'bg-white dark:bg-slate-600 shadow' : ''}`} title="LOB Stats"><BarChart3 size={18}/></button>
                        </div>
                        <button onClick={() => setShowActiveOnly(!showActiveOnly)} className={`flex gap-2 px-3 py-2 rounded-lg text-sm border ${showActiveOnly ? 'bg-green-50 text-green-700 border-green-200' : 'bg-slate-50 text-slate-500 border-slate-200'}`}>{showActiveOnly ? <Eye size={18}/> : <EyeOff size={18}/>} <span className="hidden sm:inline">Active Only</span></button>
                        <button onClick={handleSheetLink} className="p-2 text-slate-500 hover:bg-slate-100 rounded"><LinkIcon size={18}/></button>
                        <button onClick={handleExport} className="p-2 text-slate-500 hover:bg-slate-100 rounded"><Download size={18}/></button>
                        <button onClick={handleManualSync} className="p-2 text-slate-500 hover:bg-slate-100 rounded" title="Sync with Sheet"><RefreshCw size={18}/></button>

                        <div className="flex items-center gap-2 border-l border-slate-200 dark:border-slate-700 pl-3">
                            <span className="text-xs text-slate-400 font-bold">Total in File:</span>
                            <span className="text-sm font-bold text-slate-800 dark:text-white cursor-help" title={`Active: ${stats.active}\nTotal Loaded: ${stats.total}`}>{stats.total}</span>
                        </div>
                        <button onClick={() => setDarkMode(!darkMode)} className="p-2 text-slate-500 hover:bg-slate-100 rounded">{darkMode ? <Sun size={20} className="text-amber-400"/> : <Moon size={20}/>}</button>
                    </div>
                  </div>
                </header>
                <main className="max-w-[96%] mx-auto px-4 py-8">
                   <div className="mb-6 flex gap-4 items-center justify-between">
                       <div className="bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 flex items-center gap-3">
                           <div className="bg-green-100 dark:bg-green-900/30 p-2 rounded text-green-600"><Eye size={20}/></div>
                           <div><p className="text-xs text-slate-500">Showing</p><p className="text-xl font-bold dark:text-white">{stats.visible}</p></div>
                       </div>
                       <div className="flex flex-wrap gap-2 items-center">
                           <Filter size={18} className="text-slate-400 mr-2"/>
                           {filterTitles.map(t => (
                               <button key={t} onClick={() => setSelectedTitle(t)} className={`px-3 py-1 rounded-full text-xs border ${selectedTitle === t ? 'bg-slate-800 text-white dark:bg-blue-600' : 'bg-white text-slate-600 dark:bg-slate-800 dark:text-slate-300'}`}>{t}</button>
                           ))}
                       </div>
                   </div>
                   {viewMode === 'stats' && (
                       <>
                           <LobChart data={lobStats} />
                           <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                               {lobStats.map(lob => (
                                   <div key={lob.name} className="bg-white dark:bg-slate-800 p-5 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm">
                                       <div className="flex justify-between mb-4">
                                           <div><h3 className="font-bold dark:text-white">{lob.name}</h3><p className="text-sm text-slate-500">{lob.total} employees</p></div>
                                           <Users className="text-blue-500"/>
                                       </div>
                                       <div className="w-full bg-slate-100 rounded-full h-2 mb-4"><div className="bg-blue-600 h-2 rounded-full" style={{width: `${(lob.total/stats.visible)*100}%`}}></div></div>
                                       
                                       {/* Breakdown for EVERYONE (Including MX T1 now) */}
                                       {Object.keys(lob.subChannels).length > 0 && (
                                            <div className="mt-auto space-y-2 border-t border-slate-100 dark:border-slate-700 pt-3">
                                                {Object.entries(lob.subChannels).map(([sub, count]) => (
                                                <div key={sub} className="flex justify-between items-center text-xs">
                                                    <span className="text-slate-500 dark:text-slate-400 font-medium flex items-center gap-1.5">
                                                    {sub.toLowerCase().includes('phone') ? <Phone size={10} /> :
                                                    sub.toLowerCase().includes('email') ? <Mail size={10} /> :
                                                    sub.toLowerCase().includes('chat') ? <MessageCircle size={10} /> :
                                                    <div className="w-2.5 h-2.5 rounded-full bg-slate-300 dark:bg-slate-600"></div>}
                                                    {sub}
                                                    </span>
                                                    <span className="font-bold text-slate-700 dark:text-slate-200 bg-slate-100 dark:bg-slate-700 px-1.5 py-0.5 rounded">{count}</span>
                                                </div>
                                                ))}
                                            </div>
                                       )}
                                       
                                       {/* Only MX T1 is collapsible */}
                                       {lob.name === 'MX T1' ? (
                                           <>
                                               <button onClick={() => setExpandedStats(prev => ({...prev, [lob.name]: !prev[lob.name]}))} className="w-full text-xs flex justify-between items-center py-2 text-slate-500 hover:text-blue-600 border-t border-slate-100 dark:border-slate-700 mt-3">
                                                   <span>{expandedStats[lob.name] ? 'Hide' : 'Show'} Agents</span><ChevronDown size={14}/>
                                               </button>
                                               {expandedStats[lob.name] && (
                                                   <div className="mt-2 space-y-1 max-h-60 overflow-y-auto text-xs">
                                                       {lob.employees.map(e => (
                                                           <div key={e.id} onClick={() => openViewModal(e)} className="p-2 hover:bg-slate-50 dark:hover:bg-slate-700 rounded cursor-pointer flex gap-2 items-center">
                                                               <div className="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-[10px] text-blue-600 font-bold">{e.name.charAt(0)}</div>
                                                               <div className="truncate flex-1"><p className="font-medium dark:text-slate-200 truncate">{e.name}</p><p className="text-slate-400 truncate">{e.title}</p></div>
                                                           </div>
                                                       ))}
                                                   </div>
                                               )}
                                           </>
                                       ) : (
                                           <div className="mt-4 space-y-1 max-h-60 overflow-y-auto text-xs border-t border-slate-100 dark:border-slate-700 pt-3">
                                               {lob.employees.map(e => (
                                                   <div key={e.id} onClick={() => openViewModal(e)} className="p-2 hover:bg-slate-50 dark:hover:bg-slate-700 rounded cursor-pointer flex gap-2 items-center">
                                                       <div className="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-[10px] text-blue-600 font-bold">{e.name.charAt(0)}</div>
                                                       <div className="truncate flex-1"><p className="font-medium dark:text-slate-200 truncate">{e.name}</p><p className="text-slate-400 truncate">{e.title}</p></div>
                                                   </div>
                                               ))}
                                           </div>
                                       )}
                                   </div>
                               ))}
                           </div>
                       </>
                   )}
                   {viewMode === 'map' && (
                       <div className="space-y-8">
                           {Object.entries(groupedData).map(([lob, employees]) => (
                               <div key={lob}>
                                   <div className="flex items-center gap-4 mb-4"><h2 className="text-lg font-bold dark:text-white">{lob}</h2><span className="text-xs bg-slate-200 px-2 py-0.5 rounded-full">{employees.length}</span><div className="h-px bg-slate-200 flex-1"></div></div>
                                   <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                                       {employees.map(e => <EmployeeWidget key={e.id} employee={e} onClick={() => openViewModal(e)} onEdit={openEditModal} onDelete={handleDelete}/>)}
                                   </div>
                               </div>
                           ))}
                       </div>
                   )}
                   {viewMode === 'list' && (
                       <div className="bg-white dark:bg-slate-800 rounded-xl shadow-sm overflow-hidden">
                           <table className="w-full text-left text-sm text-slate-600 dark:text-slate-300">
                               <thead className="bg-slate-50 dark:bg-slate-900 font-semibold text-slate-500 dark:text-slate-400"><tr><th className="p-4">Employee</th><th className="p-4">Title</th><th className="p-4">Channel</th><th className="p-4">Status</th><th className="p-4 text-right">Actions</th></tr></thead>
                               <tbody className="divide-y divide-slate-100 dark:divide-slate-700">
                                   {filteredData.map(e => <EmployeeRow key={e.id} employee={e} onClick={() => openViewModal(e)} onEdit={openEditModal} onDelete={handleDelete}/>)}
                               </tbody>
                           </table>
                       </div>
                   )}
                </main>
            </div>
          );
        }

        const container = document.getElementById('root');
        const root = createRoot(container);
        root.render(<HeadcountDashboard />);
    </script>
</body>
</html>
